{%- comment -%}
Snippet: Zack — Countdown timer
Usage: {% render 'zack-countdown', label: 'Pre‑order ends in', end_date: section.settings.countdown_end %}
Notes: Minimal JS, updates once per second; displays d hh:mm:ss
{%- endcomment -%}

{%- assign countdown_label = label | default: 'Pre‑order ends in' -%}
{%- assign end_dt = end_date -%}
<div class="z-countdown" data-end-date="{{ end_dt | escape }}">
  <span class="z-countdown__label">{{ countdown_label }}</span>
  <span class="z-countdown__time" aria-live="polite">--:--:--</span>
</div>
<script>
(function(){
  var root = document.currentScript.previousElementSibling;
  if(!root) return;
  var endStr = root.getAttribute('data-end-date');
  if(!endStr) return;
  var end = new Date(endStr);
  function fmt(n){return (n<10?'0':'')+n;}
  function tick(){
    var now = new Date();
    var diff = end - now;
    var view = root.querySelector('.z-countdown__time');
    if(!view) return;
    if(diff <= 0){ view.textContent = '00:00:00'; return; }
    var days = Math.floor(diff/86400000);
    var hrs = Math.floor((diff%86400000)/3600000);
    var mins = Math.floor((diff%3600000)/60000);
    var secs = Math.floor((diff%60000)/1000);
    view.textContent = (days>0?days+'d ':'')+fmt(hrs)+':'+fmt(mins)+':'+fmt(secs);
  }
  tick();
  setInterval(tick, 1000);
})();
</script>
