{%- comment -%}
Section: Product — Urgency & Pre‑Order CTA
Purpose: Drive conversions with countdown, limited availability, streamlined CTA
{%- endcomment -%}

{{ 'zack-modules.css' | asset_url | stylesheet_tag }}

<section id="z-preorder" class="z-section" data-section-id="{{ section.id }}">
  <div class="z-container">
    <h2 class="z-visually-hidden">Pre‑Order</h2>

    {%- if section.settings.countdown_end != blank and section.settings.show_countdown -%}
      {% render 'zack-countdown', label: section.settings.countdown_label, end_date: section.settings.countdown_end %}
    {%- endif -%}

    {%- if section.settings.enable_inventory_check and product -%}
      {%- assign inv = product.selected_or_first_available_variant.inventory_quantity -%}
      {%- if inv and inv > 0 -%}
        <p class="z-urgency__stock">Only {{ inv }} left — reserve yours now.</p>
      {%- endif -%}
    {%- elsif section.settings.limited_qty != blank -%}
      <p class="z-urgency__stock">Limited release: {{ section.settings.limited_qty }} units.</p>
    {%- endif -%}

    <div style="margin-top:12px">
      {% render 'zack-cta', product_handle: section.settings.product_handle, text: section.settings.cta_text, variant_id: section.settings.variant_id %}
    </div>

    {%- if section.settings.secondary_cta_text != blank and section.settings.secondary_cta_link != blank -%}
      <div style="margin-top:8px">
        <a class="z-btn z-btn--ghost z-btn--full" href="{{ section.settings.secondary_cta_link }}">{{ section.settings.secondary_cta_text }}</a>
      </div>
    {%- endif -%}

    {%- if section.settings.disclaimer != blank -%}
      <p style="margin-top:8px;color:var(--z-muted);font-size:.9rem">{{ section.settings.disclaimer }}</p>
    {%- endif -%}
  </div>
</section>

{% schema %}
{
  "name": "Product — Urgency & Pre‑Order CTA",
  "tag": "section",
  "class": "section",
  "settings": [
    {"type":"checkbox","id":"show_countdown","label":"Show countdown","default":true},
    {"type":"text","id":"countdown_label","label":"Countdown label","default":"Pre‑order ends in"},
    {"type":"text","id":"countdown_end","label":"Countdown end (ISO date)","default":"2025-11-30T23:59:59Z"},
    {"type":"checkbox","id":"enable_inventory_check","label":"Show live inventory from selected variant","default":true},
    {"type":"text","id":"limited_qty","label":"Fallback limited quantity (text)","default":"500"},
    {"type":"text","id":"product_handle","label":"Product handle (for non‑product pages)","default":"zack-ai-learning-companion"},
    {"type":"text","id":"variant_id","label":"Variant ID (optional)","default":""},
    {"type":"text","id":"cta_text","label":"Primary CTA text","default":"Pre‑Order Now"},
    {"type":"text","id":"secondary_cta_text","label":"Secondary CTA text","default":"See Technical Specs"},
    {"type":"url","id":"secondary_cta_link","label":"Secondary CTA link","default":"#z-tech-specs"},
    {"type":"textarea","id":"disclaimer","label":"Optional disclaimer","default":"Delivery timeline: 8–10 months post‑campaign. Voice cloning requires parental consent."}
  ],
  "presets": [
    {
      "name": "Product — Urgency & Pre‑Order CTA",
      "category": "Product"
    }
  ]
}
{% endschema %}
